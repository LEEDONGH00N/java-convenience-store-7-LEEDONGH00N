# **기능 요구 사항**

## **1. 시스템 시작 및 종료**

- **환영 메시지 출력**: 시스템 시작 시 환영 인사와 현재 상품 목록을 안내
- **추가 구매 여부 확인**: 영수증 출력 후 추가 구매를 진행할지 종료할지 입력 받음

## **2. 상품 목록 출력**

- **상품 목록 파일 읽기**: src/main/resources/products.md 파일에서 상품 정보를 불러옴
- **프로모션 목록 파일 읽기**: src/main/resources/promotions.md 파일에서 프로모션 정보를 불러옴
- **현재 재고 출력**: 상품명, 가격, 재고 수량, 프로모션 정보 등을 출력
- 재고가 0인 경우, “재고 없음” 메시지를 출력

## **3. 상품 선택 및 결제**

- **상품 및 수량 입력**: 사용자가 구매할 상품명과 수량을 입력
- **입력 형식 검증**: 입력 형식이 올바르지 않을 경우 [ERROR] 메시지를 출력하고 재입력을 요청
- **상품 유효성 확인**: 존재하지 않는 상품을 입력한 경우 [ERROR] 존재하지 않는 상품입니다. 메시지 출력.
- **재고 확인**: 재고 수량을 초과하는 경우 [ERROR] 재고 수량을 초과하여 구매할 수 없습니다. 메시지 출력.

## **4. 프로모션 할인 적용**

- **프로모션 기간 검증**: 현재 날짜가 프로모션 기간 내에 포함된 경우에만 프로모션을 적용
- **N+1 프로모션 적용**: 프로모션 조건(N개 구매 시 1개 무료)에 따라 할인 적용
- **프로모션 재고 사용**: 프로모션 적용 시 프로모션 재고를 우선적으로 차감
- **프로모션 추가 안내**: 사용자가 프로모션 혜택을 받을 수 있는 수량보다 적게 입력한 경우 추가 수량 확인
- **프로모션 재고 부족 시 정가 결제 안내**: 프로모션 재고가 부족할 경우 정가로 구매할지 확인

## **5. 멤버십 할인 적용**

- **멤버십 할인 여부 확인**: 사용자가 멤버십 할인을 적용할지 여부를 입력받음
- **멤버십 할인 계산**: 프로모션이 적용된 금액을 제외한 금액의 30% 할인 적용 (최대 할인 한도: 8,000원).

## **6. 영수증 출력**

- **구매 내역 출력**: 상품명, 수량, 가격을 정리하여 출력.
- **증정 상품 내역 출력**: 프로모션에 따라 무료로 제공된 증정 상품 목록 출력.
- **결제 요약 출력**:
    - 총구매액: 구매한 상품의 총 수량과 총 금액
    - 행사할인: 프로모션에 의해 할인된 금액
    - 멤버십할인: 멤버십에 의해 추가로 할인된 금액
    - 내실돈: 최종 결제 금액

## **7. 추가 구매 여부 확인**

- **추가 구매 확인**: 영수증 출력 후 추가 구매 여부 확인
- 추가 구매 시 최신 재고 상태를 출력

# 프로젝트 구조

```
    ├── main
    │   ├── java
    │   │   └── store
    │   │       ├── Application.java
    │   │       ├── controller
    │   │       │   └── ConvenienceController.java
    │   │       ├── exception
    │   │       │   └── ConvenienceExceptionStatus.java
    │   │       ├── model
    │   │       │   ├── products
    │   │       │   │   ├── NormalProduct.java
    │   │       │   │   ├── Product.java
    │   │       │   │   ├── ProductStock.java
    │   │       │   │   └── PromotionProduct.java
    │   │       │   ├── promotions
    │   │       │   │   └── Promotion.java
    │   │       │   └── receipt
    │   │       │       ├── Purchase.java
    │   │       │       └── Receipt.java
    │   │       ├── properties
    │   │       │   ├── FileProperties.java
    │   │       │   └── MembershipProperties.java
    │   │       ├── utils
    │   │       │   ├── files
    │   │       │   │   ├── ProductsFileReader.java
    │   │       │   │   └── PromotionsFileReaders.java
    │   │       │   ├── membership
    │   │       │   │   └── MembershipUtils.java
    │   │       │   └── validator
    │   │       │       └── InputValidator.java
    │   │       └── views
    │   │           ├── InputView.java
    │   │           └── OutputView.java
    │   └── resources
    │       ├── products.md
    │       └── promotions.md
    └── test
        └── java
            ├── model
            │   ├── PromotionTest.java
            │   └── ReceiptTest.java
            └── store
                └── ApplicationTest.java

```

## 재고 관리 클래스들

 ProductStock

: 한 제품에 대한 재고 정보를 가지는 클래스

- Product
- NormalStock
- PromotionStock

 Product

: 제품의 이름 및 가격 정보를 가진 클래스

 NormalStock

: 일반 상품의 재고 정보를 가진 클래스

 PromotionStock

: 프로모션 상품의 재고 정보를 가진 클래스

## 프로모션 클래스

 Promotion

: 프로모션 이름, 정보, 날짜를 가진 클래스

## 영수증 클래스

 Receipt

: 구매한 물건 리스트, 총 가격, 할인 가격 등을 가진 클래스

 Purchase

: 구매한 물건에 대한 총 구매 개수, 프로모션 상품 개수, 프로모션 적용 금액에 대한 정보를 가진 클래스

---

## 구매 요청 시 프로세스

<선행>

1. 각 주문 별 영수증 객체 생성
2. 해당 상품의 총 재고(일반 + 프로모션)가 충분한지 확인

<프로모션 재고가 있는 경우 프로모션 재고 우선 차감>

1. 프로모션 기간인가?
2. 프로모션 재고에서 전부 차감할 수 있는가?
    - true일때
        1. 추가 증정품을 받을 수 있는 주문인가? (ex. 2+1 프로모션에서 5개를 주문한 경우 1개를 더받을 수 있음)
            - true일 때
                1. 추가 증정품까지 줄 수 있는 재고인가?
                    - true → 구매 진행
                    - false

                      → 증정품 제공이 불가함을 명시한 후, 원래 주문량으로 구매 진행

            - false일 때

              → 기존 주문량으로 구매 진행

    - false일 때

      → n개가 프로모션 혜택을 받을 수 없음을 고지

      → 답변에 따라 그냥 결제할지 말지 진행

      → 일부 주문을 일반 재고에서 차감

3. 주문이 완료되면, 영수증에 구매 정보를 입력
    - 상품 별 정보, 프로모션 상품 개수, 총 금액, 총 개수, 프로모션 적용 금액 받음
4. 멤버십 할인 유무를 확인한 후, 할인 금액을 영수증에 입력
    - 할인 금액의 최대액은 8000

      → 한 주문 당 최대액이라 판단하였음. 누적 X